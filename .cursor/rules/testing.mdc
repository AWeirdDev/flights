---
globs: test_*.py,*_test.py
---

# Testing Guidelines

## Test Files
- Place test files in the project root (e.g., [test.py](mdc:test.py), [test_bright_data.py](mdc:test_bright_data.py))
- Name test files with `test_` prefix or `_test` suffix
- Each test file should be runnable independently

## Test Structure
```python
from fast_flights import get_flights, FlightData, Passengers, Result

# Test with real API calls
result: Result = get_flights(
    flight_data=[
        FlightData(date="2025-01-01", from_airport="TPE", to_airport="MYJ")
    ],
    trip="one-way",
    seat="economy",
    passengers=Passengers(adults=2, children=1),
    fetch_mode="fallback",  # Use fallback mode for reliability
)

assert result.flights, "Should return flights"
print(result)
```

## Testing Best Practices
- Use descriptive assertions with error messages
- Test with multiple fetch modes when relevant
- Use real dates in the future (not past dates)
- Test edge cases: multi-city trips, different seat classes, various passenger combinations
- Verify both successful responses and error handling

## Data for Testing
- Use valid 3-letter IATA airport codes
- Test with international routes to catch regional issues
- Consider time zones and date line crossing scenarios

## Testing Fetch Strategies
- Test with `fetch_mode="common"` first (fastest)
- Use `fetch_mode="fallback"` for more reliable tests
- Test `fetch_mode="local"` when Playwright is installed
- Only test `fetch_mode="bright-data"` with valid credentials

## Jupyter Notebooks
- Use [data_discovery.ipynb](mdc:data_discovery.ipynb) for exploratory testing and debugging
- Keep notebooks for documentation and experimentation
- Export important discoveries to proper test files
